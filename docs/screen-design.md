# 画面設計書

## 概要
WhereToAnimeの全画面設計とUIコンポーネントの詳細仕様

## デザインシステム

### カラーパレット
- **背景**: `bg-white` (白)
- **テキスト**: `text-gray-900` (濃いグレー)
- **セカンダリテキスト**: `text-gray-600` / `text-gray-500`
- **ボーダー**: `border-gray-200` / `border-gray-300`
- **アクセント**: `bg-gray-900` (ボタン)
- **ホバー**: `hover:bg-gray-50` / `hover:bg-gray-800`

### タイポグラフィ
- **大見出し**: `text-6xl font-medium` (Hero)
- **中見出し**: `text-3xl font-medium` / `text-2xl font-medium`
- **小見出し**: `text-xl font-medium` / `text-lg font-medium`
- **本文**: `text-base` / `text-sm`
- **キャプション**: `text-xs`

### スペーシング
- **コンテナ**: `container mx-auto px-6`
- **セクション間**: `py-16` / `py-12` / `py-8`
- **要素間**: `mb-6` / `mb-4` / `mb-3`
- **カード内**: `p-6` / `p-4`

### アニメーション
- **フェードイン**: `animate-fadeIn` (0.6s ease-out)
- **スライドアップ**: `animate-slideUp` (0.6s ease-out)
- **スライドダウン**: `animate-slideDown` (0.3s ease-out)
- **段階的表示**: `animationDelay: '0.1s'` 刻み

---

## 1. ランディングページ (`/`)

### レイアウト構成
```
┌─────────────────────────────────────────┐
│ Header (固定ヘッダー)                      │
│  - ロゴ                                  │
│  - ログイン/新規登録 または ユーザーメニュー  │
├─────────────────────────────────────────┤
│ Hero Section                             │
│  - 大見出し「アニメを見る場所を即座に発見」   │
│  - サブテキスト                           │
│  - 検索バー (オートコンプリート機能付き)     │
├─────────────────────────────────────────┤
│ 対応プラットフォーム Section               │
│  - 6カラムグリッド (レスポンシブ)           │
│  - プラットフォームカード                   │
├─────────────────────────────────────────┤
│ 話題のアニメ Section                      │
│  - 6カラムグリッド                        │
│  - アニメカード                           │
└─────────────────────────────────────────┘
```

### コンポーネント詳細

#### Header
- **位置**: `sticky top-0`
- **背景**: `bg-white/80 backdrop-blur-xl`
- **高さ**: `py-4`
- **ボーダー**: `border-b border-gray-200`

#### 検索バー
- **ファイル**: `/src/components/SearchBar.tsx`
- **機能**:
  - リアルタイムオートコンプリート (300msデバウンス)
  - APIエンドポイント: `/api/anime/search?q=`
  - 英語/日本語タイトル対応
  - 段階的フェードイン表示
- **デザイン**:
  - `rounded-2xl` 丸み
  - `bg-gray-50` 背景
  - `border-gray-200` ボーダー
  - フォーカス時: `border-gray-400`
  - アイコン: 検索ボタン (右側)

#### プラットフォームカード
- **ファイル**: `/src/components/PlatformGrid.tsx`
- **レイアウト**: `grid-cols-2 md:grid-cols-3 lg:grid-cols-6`
- **構成**:
  - グラデーションアイコン (プラットフォーム名の頭文字)
  - プラットフォーム名
  - 月額料金
- **インタラクション**:
  - ホバー: `border-gray-300` + `shadow-md`
  - アイコン: `group-hover:scale-105`

#### アニメカード（トレンド表示）
- **ファイル**: `/src/components/FeaturedAnime.tsx`
- **データソース**: Jikan API (MyAnimeList公式データ)
- **APIエンドポイント**: `/api/anime/trending`
- **アスペクト比**: `aspect-[3/4]`
- **構成**:
  - 画像エリア (実際のアニメ画像 + フォールバック背景)
  - タイトル（英語/日本語）
  - 評価スコア（★マーク + 数値）
  - ジャンルタグ（最大3つ）
- **ホバー効果**:
  - オーバーレイ表示
  - 詳細情報（評価、ジャンル）のスライドアップ
- **トレンド判定基準**:
  - MyAnimeListのランキングアルゴリズム
  - ユーザー評価スコア（1-10点）
  - 視聴者数・お気に入り数
  - 現在放送中の作品のみ（`filter=airing`）
  - 1時間ごとにキャッシュ更新

---

## 2. 検索結果ページ (クライアント側表示)

### レイアウト構成
```
┌─────────────────────────────────────────┐
│ 検索バー (同じ位置に表示)                  │
├─────────────────────────────────────────┤
│ 検索結果一覧                              │
│  ┌───────────────────────────────────┐  │
│  │ [画像] アニメタイトル      [最安バッジ]│  │
│  │        英語タイトル                 │  │
│  │        あらすじ (2行まで)            │  │
│  │        2020年 | 24話 | 放送中        │  │
│  │        [ジャンル] [ジャンル]         │  │
│  │        [Crunchyroll] [Netflix]      │  │
│  │                    [価格を比較 →]   │  │
│  └───────────────────────────────────┘  │
│  (繰り返し)                              │
├─────────────────────────────────────────┤
│ ページネーション (複数ページの場合)         │
└─────────────────────────────────────────┘
```

### コンポーネント詳細

#### 検索結果カード
- **ファイル**: `/src/components/SearchResults.tsx`
- **レイアウト**: 縦積み、カード形式
- **構成**:
  - 左: アニメ画像 (150x200px)
  - 右: 詳細情報
- **最安値バッジ**:
  - `bg-green-50 border-green-200`
  - `text-green-700`
  - アイコン: TrendingDown
- **プラットフォームタグ**:
  - `bg-gray-50 border-gray-200`
  - 字幕/吹替表示 (`text-green-600` / `text-blue-600`)
- **価格比較ボタン**:
  - `bg-gray-900 text-white`
  - `rounded-xl`
  - アイコン: DollarSign

---

## 3. 価格比較モーダル

### レイアウト構成
```
┌─────────────────────────────────────────┐
│ 価格比較            [×]                  │
├─────────────────────────────────────────┤
│ [アニメタイトル]                          │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ プラットフォーム比較テーブル            │ │
│ │ Platform | 月額 | 年額 | エピ | 字/吹│ │
│ │ Netflix  | ¥xxx | ¥xxx | 24   | 両方│ │
│ │ Crunch.  | ¥xxx | ¥xxx | 24   | 字幕│ │
│ └─────────────────────────────────────┘ │
│                                         │
│ [最安値の推奨表示]                        │
└─────────────────────────────────────────┘
```

### デザイン詳細
- **背景オーバーレイ**: `bg-black/30 backdrop-blur-sm`
- **モーダル**: `bg-white rounded-2xl border-gray-200`
- **ヘッダー**: `border-b border-gray-200`
- **閉じるボタン**: `text-gray-400 hover:text-gray-900`

---

## 4. ダッシュボード (`/dashboard`)

### レイアウト構成
```
┌─────────────────────────────────────────┐
│ Header (同じ)                            │
├─────────────────────────────────────────┤
│ Welcome Section                          │
│  - こんにちは、[ユーザー名]さん            │
│  - 検索バー                              │
├─────────────────────────────────────────┤
│ ウォッチリストの新エピソード               │
│  🔔 新エピソード (2)                      │
│  ┌─────────────────────────────────┐   │
│  │ [サムネ] Demon Slayer               │   │
│  │          🆕 第56話 2日前            │   │
│  │          Netflix | Crunchyroll      │   │
│  │          [Netflixで視聴 →]         │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│ ウォッチリスト (6カラム)                  │
│  [♥][♥][♥][♥][♥][♥]                    │
├─────────────────────────────────────────┤
│ トレンド中のアニメ (6カラム)              │
│  [★9.2][★8.8][★8.6]...                 │
├─────────────────────────────────────────┤
│ 統計情報 (3カラム)                       │
│  [▶ 12] [♥ 24] [📈 156]                │
│  視聴中   お気に入り   視聴済み            │
├─────────────────────────────────────────┤
│ 注目の予告編                              │
│  [▶ Frieren YouTube Trailer]            │
└─────────────────────────────────────────┘
```

### コンポーネント詳細

#### 新エピソード通知カード
- **ファイル**: `/src/components/NewEpisodes.tsx`
- **機能**: ウォッチリストのアニメの新エピソード配信通知
- **デザイン**:
  - ベルアイコン + 新エピソード数バッジ (`bg-red-500 text-white`)
  - 横並びレイアウト (サムネイル + 情報)
  - サムネイル: `w-24 h-36` (縦長)
- **情報表示**:
  - アニメタイトル
  - 新エピソードバッジ (`bg-green-100 text-green-800`)
  - 配信日 (相対表示: 今日/昨日/○日前)
  - 視聴可能プラットフォーム
  - アフィリエイトリンクボタン
- **インタラクション**:
  - ホバー: `border-gray-300`
  - ボタン: `bg-blue-600 hover:bg-blue-700`

#### 予告編プレイヤー
- **ファイル**: `/src/components/TrailerPlayer.tsx`
- **機能**: YouTube動画埋め込みプレイヤー
- **デザイン**:
  - アスペクト比: `aspect-video`
  - サムネイル表示 → クリックで動画再生
  - 再生ボタンオーバーレイ (`bg-black/30`)
  - 閉じるボタン (`absolute top-4 right-4`)
- **動作**:
  - デフォルト: YouTubeサムネイル + 再生ボタン
  - クリック: YouTube iframe埋め込み (autoplay=1)
  - 閉じる: サムネイルに戻る

#### ウォッチリストカード
- **ハートアイコン**: `absolute top-2 right-2`
- **背景**: `bg-white/90 backdrop-blur-sm`
- **アイコン色**: `text-red-500 fill-red-500`

#### トレンドカード
- **評価バッジ**: `absolute top-2 left-2`
- **背景**: `bg-yellow-400`
- **アイコン**: Star (塗りつぶし)

#### 統計カード
- **レイアウト**: 横並び (アイコン + 数値)
- **アイコン背景**:
  - 青: `bg-blue-50 text-blue-600`
  - 赤: `bg-red-50 text-red-600`
  - 緑: `bg-green-50 text-green-600`

---

## 5. ログイン/新規登録ページ

### レイアウト構成
```
┌─────────────────────────────────────────┐
│          [WhereToAnime Logo]             │
│              ログイン                     │
│     アカウントにログインしてください        │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 📧 メールアドレス                 │   │
│  │ [input field]                    │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │ 🔒 パスワード                     │   │
│  │ [input field]                    │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │      [ログインボタン]              │   │
│  └─────────────────────────────────┘   │
│                                         │
│        ───────  または  ───────          │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ [G] Googleでログイン              │   │
│  └─────────────────────────────────┘   │
│                                         │
│   アカウントをお持ちでない方は 新規登録     │
└─────────────────────────────────────────┘
```

### デザイン詳細

#### フォームフィールド
- **ファイル**: `/src/components/auth/LoginForm.tsx` / `SignupForm.tsx`
- **背景**: `bg-gray-50`
- **ボーダー**: `border-gray-200`
- **フォーカス**: `focus:border-gray-400`
- **アイコン**: 左側に配置 (`absolute left-3`)

#### ボタン
- **メインボタン**: `bg-gray-900 text-white rounded-xl`
- **Googleボタン**: `bg-white border-gray-200`
- **ホバー**: `hover:bg-gray-800` / `hover:bg-gray-50`
- **アクティブ**: `active:scale-[0.98]`

#### エラー表示
- **背景**: `bg-red-50 border-red-200`
- **テキスト**: `text-red-800`
- **アイコン**: AlertCircle

#### 成功表示
- **背景**: `bg-green-50 border-green-200`
- **テキスト**: `text-green-800`
- **アイコン**: CheckCircle

---

## 6. ユーザーメニュー (ドロップダウン)

### レイアウト
```
┌──────────────────────────┐
│ [アバター] user@email ▼  │  ← トリガー
└──────────────────────────┘
   ↓ (クリック時)
┌──────────────────────────┐
│ ログイン中               │
│ user@email.com          │
├──────────────────────────┤
│ 👤 ダッシュボード         │
│ ⚙️  設定                 │
│ 💳 プレミアムプラン       │
├──────────────────────────┤
│ 🚪 ログアウト            │
└──────────────────────────┘
```

### デザイン詳細
- **ファイル**: `/src/components/auth/UserMenu.tsx`
- **トリガー**: `rounded-lg hover:bg-gray-100`
- **ドロップダウン**: `bg-white rounded-xl shadow-lg border-gray-200`
- **メニュー項目**: `hover:bg-gray-50`
- **アバター**: `bg-gray-900 rounded-full`

---

## レスポンシブブレークポイント

### Tailwind設定
- **sm**: 640px (モバイル横)
- **md**: 768px (タブレット)
- **lg**: 1024px (デスクトップ小)
- **xl**: 1280px (デスクトップ大)

### グリッド対応
```css
/* プラットフォーム・アニメカード */
grid-cols-2           /* モバイル */
md:grid-cols-3        /* タブレット */
lg:grid-cols-6        /* デスクトップ */

/* 視聴を続ける */
grid-cols-1           /* モバイル */
md:grid-cols-3        /* タブレット以上 */

/* 統計情報 */
grid-cols-1           /* モバイル */
md:grid-cols-3        /* タブレット以上 */
```

---

## アクセシビリティ

### キーボード操作
- Tab順序: 論理的な順序
- Enter/Space: ボタン・リンク動作
- Escape: モーダルを閉じる

### ARIA属性
- `aria-label`: アイコンボタン
- `role="dialog"`: モーダル
- `aria-expanded`: ドロップダウン状態

### カラーコントラスト
- テキスト/背景: WCAG AA準拠
- リンク: 下線表示オプション

---

## アニメーション仕様

### Tailwind設定 (`tailwind.config.ts`)
```typescript
animation: {
  'fadeIn': 'fadeIn 0.6s ease-out forwards',
  'slideUp': 'slideUp 0.6s ease-out forwards',
  'slideDown': 'slideDown 0.3s ease-out forwards',
}
keyframes: {
  fadeIn: {
    '0%': { opacity: '0', transform: 'translateY(10px)' },
    '100%': { opacity: '1', transform: 'translateY(0)' },
  },
  slideUp: {
    '0%': { opacity: '0', transform: 'translateY(20px)' },
    '100%': { opacity: '1', transform: 'translateY(0)' },
  },
  slideDown: {
    '0%': { opacity: '0', transform: 'translateY(-10px)' },
    '100%': { opacity: '1', transform: 'translateY(0)' },
  },
}
```

### 段階的表示
```tsx
style={{ animationDelay: `${index * 0.05}s` }}
```

---

## パフォーマンス考慮事項

### 画像最適化
- Next.js Image コンポーネント使用
- 遅延読み込み (Lazy Loading)
- 適切なサイズ指定

### アニメーション
- CSS transform/opacity のみ使用
- GPU アクセラレーション活用
- `will-change` 最小限使用

### 検索
- デバウンス: 300ms
- キャンセル可能なリクエスト

---

## 実装ファイル一覧

### ページ
- `/src/app/page.tsx` - ランディングページ
- `/src/app/login/page.tsx` - ログイン
- `/src/app/signup/page.tsx` - 新規登録
- `/src/app/dashboard/page.tsx` - ダッシュボード

### コンポーネント
- `/src/components/ClientHome.tsx` - ホームクライアント
- `/src/components/SearchBar.tsx` - 検索バー
- `/src/components/SearchResults.tsx` - 検索結果
- `/src/components/PlatformGrid.tsx` - プラットフォーム一覧
- `/src/components/FeaturedAnime.tsx` - 人気アニメ
- `/src/components/DashboardContent.tsx` - ダッシュボードコンテンツ
- `/src/components/PriceComparisonTable.tsx` - 価格比較テーブル

### 認証
- `/src/components/auth/LoginForm.tsx` - ログインフォーム
- `/src/components/auth/SignupForm.tsx` - 新規登録フォーム
- `/src/components/auth/UserMenu.tsx` - ユーザーメニュー

---

## 今後の拡張予定

### 未実装機能
1. **フィルター機能** - ジャンル、年代、評価
2. **ソート機能** - 評価順、新着順、人気順
3. **詳細ページ** - アニメごとの詳細情報
4. **レビュー機能** - ユーザーレビュー・評価
5. **通知センター** - 価格変更、新エピソード
6. **プレミアム機能** - 高度な検索、API アクセス
7. **管理画面** - データ管理、分析

### デザイン改善
1. **ダークモード** - ライト/ダーク切り替え
2. **カスタマイズ** - テーマカラー設定
3. **アクセシビリティ** - スクリーンリーダー対応強化